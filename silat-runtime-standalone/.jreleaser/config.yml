#
# SPDX-License-Identifier: Apache-2.0
# Copyright (c) The original authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

project:
  name: silat-runtime-standalone
  description: Silat Standalone Workflow Engine Runtime
  longDescription: A self-contained workflow engine runtime that includes everything needed to run workflows without external dependencies
  links:
    homepage: https://github.com/kayys/silat
  authors:
    - Kayys Tech Team
  license: Apache-2.0
  inceptionYear: 2024

release:
  github:
    owner: kayys
    name: silat
    overwrite: true
    changelog:
      formatted: ALWAYS
      preset: conventional-commits
      contributors:
        enabled: true
        format: '- {{contributorName}}{{#contributorUsernameAsLink}} ({{contributorUsernameAsLink}}){{/contributorUsernameAsLink}}'

distributions:
  silat-runtime-standalone:
    type: JAVA_BINARY
    artifact:
      path: target/silat-runtime-standalone-{{projectVersion}}-runner.jar
      transformName: 'silat-runtime-standalone-{{projectVersion}}.jar'
    executable:
      name: silat-standalone
      windowsExtension: exe
    java:
      mainClass: tech.kayys.silat.runtime.standalone.SilatStandaloneRuntime
    artifacts:
      # Native binaries for different platforms
      - path: target/silat-runtime-standalone-{{projectVersion}}-runner
        platform: 'linux-x86_64'
        transformName: 'silat-runtime-standalone-{{projectVersion}}-linux-x64'
      - path: target/silat-runtime-standalone-{{projectVersion}}-runner
        platform: 'linux-aarch64'
        transformName: 'silat-runtime-standalone-{{projectVersion}}-linux-arm64'
      - path: target/silat-runtime-standalone-{{projectVersion}}-runner.exe
        platform: 'windows-x86_64'
        transformName: 'silat-runtime-standalone-{{projectVersion}}-windows-x64.exe'
      - path: target/silat-runtime-standalone-{{projectVersion}}-runner
        platform: 'osx-x86_64'
        transformName: 'silat-runtime-standalone-{{projectVersion}}-macos-x64'
      - path: target/silat-runtime-standalone-{{projectVersion}}-runner
        platform: 'osx-aarch64'
        transformName: 'silat-runtime-standalone-{{projectVersion}}-macos-arm64'

signing:
  active: RELEASE
  armored: true

packagers:
  brew:
    active: RELEASE
    formulaName: silat-runtime-standalone
    homepage: https://github.com/kayys/silat
    description: Silat Standalone Workflow Engine Runtime
    dependencies:
      - name: openjdk
        minimumVersion: '21'
    extraProperties:
      skipCategory: true

  scoop:
    active: RELEASE
    bucket:
      owner: kayys
      name: silat
    homepage: https://github.com/kayys/silat
    description: Silat Standalone Workflow Engine Runtime
    license: Apache-2.0

  jbang:
    active: RELEASE
    file: src/main/jbang/silat-standalone.java

  nativeImage:
    active: RELEASE
    distributions:
      - silat-runtime-standalone

  docker:
    active: RELEASE
    registries:
      - repository: kayys/silat-standalone
        username: "{{env.DOCKER_USERNAME}}"
        password: "{{env.DOCKER_PASSWORD}}"
    buildx:
      enabled: true
      platforms:
        - linux/amd64
        - linux/arm64

uploadAssets:
  githubReleases:
    active: RELEASE
    files:
      - path: 'target/**/silat-runtime-standalone-*-runner.jar'
      - path: 'target/**/silat-runtime-standalone-*-runner.exe'
      - path: 'target/**/silat-runtime-standalone-*-linux-x64'
      - path: 'target/**/silat-runtime-standalone-*-linux-arm64'
      - path: 'target/**/silat-runtime-standalone-*-windows-x64.exe'
      - path: 'target/**/silat-runtime-standalone-*-macos-x64'
      - path: 'target/**/silat-runtime-standalone-*-macos-arm64'

announce:
  twitter:
    active: RELEASE
    status: 'silat-runtime-standalone {{projectVersion}} has been released! {{releaseNotesUrl}}'
  mastodon:
    active: RELEASE
    status: 'silat-runtime-standalone {{projectVersion}} has been released! {{releaseNotesUrl}}'